{%extends 'navbar.html'%}
{%block content%}
<div class="content">
    <form class="lista-produtos" id="lista-produtos" action="{{url_for('produtos')}}" method="POST" enctype="multipart/form-data">
        <input type="number" name="qtde" value="" id="qtde-produtos" hidden>
    </form>
    <div class="centralizar">
        <button type="button" class="button-add" onclick="addInputProduto()">
            <img src="{{url_for('static', filename='/images/adicionar-icon.svg')}}">
        </button>
        <button type="button" onclick="enviarProdutos()">Finalizar</button>
    </div>
</div>
<script>
    num = 0
    function addInputProduto(){
        num++
        lista = window.document.getElementById('lista-produtos')
        
        div = document.createElement("div")
        div.classList.add('produto')
        div.id = `produto-${num}`
        div.innerHTML = `
            <input type="file" name="imagem_produto-${num}" id="imagem_produto-${num}" accept="image/*" onchange="showImg(event, '#img-produto-default-${num}')" hidden>
            <div class="img-produto" id="img-produto-default-${num}" onclick="openFile('#imagem_produto-${num}')">
            </div>
            <div class="input-produto">
                <input name="id_produto-${num}" value="${num}" hidden>
                <input placeholder="Nome" name="nome_produto-${num}" id="nome_produto-${num}">
                <input placeholder="R$ 0,00" name="preco_produto-${num}" id="preco_produto-${num}">
                <textarea placeholder="&#10;Descrição" name="descricao_produto-${num}" id="descricao_produto-${num}"></textarea>
                <select name="categoria_produto-${num}" id="categoria_produto-${num}">
                    <option value="" disabled selected hidden>Categoria</option>
                    <option value="">Lanche</option>
                    <option value="">Doce</option>
                    <option value="">Bebidas</option>
                </select>
            </div>
            <img class="excluir-produto" src="{{url_for('static', filename='images/trash-icon.svg')}}" onclick="deletarProduto('produto-${num}')">`
        lista.appendChild(div)

        qtde = document.getElementById('qtde-produtos')
        qtde.value = num
    }

    function deletarProduto(id){
        elem = document.getElementById(id)
        document.getElementById('lista-produtos').removeChild(elem)
    }

    function enviarProdutos(){
        var form = window.document.querySelector('#lista-produtos')
        return form.submit()
    }
</script>
{%endblock content%}